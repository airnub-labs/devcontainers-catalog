{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.airnub.dev/devcontainers-catalog/manifest.schema.json",
  "title": "Devcontainers Catalog Workspace Manifest",
  "description": "Schema describing workspace manifests generated by the devcontainers catalog",
  "type": "object",
  "required": [
    "schemaVersion",
    "stackId",
    "catalogCommit",
    "browsers",
    "ports",
    "env",
    "paths",
    "notes"
  ],
  "additionalProperties": false,
  "properties": {
    "schemaVersion": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "stackId": {
      "type": "string"
    },
    "catalogCommit": {
      "type": "string"
    },
    "browsers": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "ports": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["port", "label", "purpose", "recommendedPrivacy"],
        "additionalProperties": false,
        "properties": {
          "port": {
            "type": "integer",
            "minimum": 1,
            "maximum": 65535
          },
          "label": {
            "type": "string"
          },
          "purpose": {
            "type": "string"
          },
          "recommendedPrivacy": {
            "type": "string",
            "enum": ["PRIVATE", "COURSE", "PUBLIC"]
          }
        }
      }
    },
    "env": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name"],
        "additionalProperties": false,
        "properties": {
          "name": { "type": "string" },
          "description": { "type": "string" },
          "required": { "type": "boolean" }
        }
      }
    },
    "paths": {
      "type": "object",
      "required": ["devcontainer", "readme"],
      "additionalProperties": false,
      "properties": {
        "devcontainer": { "type": "string" },
        "compose": { "type": "string" },
        "readme": { "type": "string" },
        "classroomBrowser": { "type": "string" }
      }
    },
    "notes": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "prefersUDP": { "type": "boolean" },
        "codespacesFallback": {
          "type": "string",
          "enum": ["tcp-mux", "https-ws"]
        },
        "other": { "type": "string" }
      }
    }
  }
}
